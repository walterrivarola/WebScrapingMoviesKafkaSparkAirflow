[2024-06-27T21:33:33.568-0400] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-06-27T21:33:33.591-0400] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_cuevana3_movie.transform_with_spark scheduled__2024-06-27T00:03:30+00:00 [queued]>
[2024-06-27T21:33:33.610-0400] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_cuevana3_movie.transform_with_spark scheduled__2024-06-27T00:03:30+00:00 [queued]>
[2024-06-27T21:33:33.611-0400] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-06-27T21:33:33.665-0400] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): transform_with_spark> on 2024-06-27 00:03:30+00:00
[2024-06-27T21:33:33.680-0400] {standard_task_runner.py:63} INFO - Started process 217354 to run task
[2024-06-27T21:33:33.691-0400] {standard_task_runner.py:90} INFO - Running: ['airflow', 'tasks', 'run', 'api_cuevana3_movie', 'transform_with_spark', 'scheduled__2024-06-27T00:03:30+00:00', '--job-id', '312', '--raw', '--subdir', 'DAGS_FOLDER/movie_recommend.py', '--cfg-path', '/tmp/tmp7hgx9yny']
[2024-06-27T21:33:33.694-0400] {standard_task_runner.py:91} INFO - Job 312: Subtask transform_with_spark
[2024-06-27T21:33:33.775-0400] {task_command.py:426} INFO - Running <TaskInstance: api_cuevana3_movie.transform_with_spark scheduled__2024-06-27T00:03:30+00:00 [running]> on host walter-VirtualBox
[2024-06-27T21:33:33.918-0400] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='api_cuevana3_movie' AIRFLOW_CTX_TASK_ID='transform_with_spark' AIRFLOW_CTX_EXECUTION_DATE='2024-06-27T00:03:30+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-27T00:03:30+00:00'
[2024-06-27T21:33:33.920-0400] {taskinstance.py:430} INFO - ::endgroup::
[2024-06-27T21:34:07.631-0400] {logging_mixin.py:188} INFO - Error al transformar datos con Spark: 
  An exception was thrown from the Python worker. Please see the stack trace below.
Traceback (most recent call last):
  File "/home/walter/Descargas/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/home/walter/Descargas/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1239, in process
    serializer.dump_stream(out_iter, outfile)
  File "/home/walter/Descargas/spark/python/lib/pyspark.zip/pyspark/serializers.py", line 225, in dump_stream
    self.serializer.dump_stream(self._batched(iterator), stream)
  File "/home/walter/Descargas/spark/python/lib/pyspark.zip/pyspark/serializers.py", line 146, in dump_stream
    for obj in iterator:
  File "/home/walter/Descargas/spark/python/lib/pyspark.zip/pyspark/serializers.py", line 214, in _batched
    for item in iterator:
  File "/home/walter/Descargas/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1070, in mapper
    result = tuple(f(*[a[o] for o in arg_offsets]) for (arg_offsets, f) in udfs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/walter/Descargas/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1070, in <genexpr>
    result = tuple(f(*[a[o] for o in arg_offsets]) for (arg_offsets, f) in udfs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/walter/Descargas/spark/python/lib/pyspark.zip/pyspark/worker.py", line 106, in <lambda>
    return lambda *a: f(*a)
                      ^^^^^
  File "/home/walter/Descargas/spark/python/lib/pyspark.zip/pyspark/util.py", line 83, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
TypeError: transform_with_spark.<locals>.clean_description() takes 0 positional arguments but 1 was given
[2024-06-27T21:34:07.663-0400] {python.py:237} INFO - Done. Returned value was: None
[2024-06-27T21:34:07.667-0400] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-06-27T21:34:09.309-0400] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=api_cuevana3_movie, task_id=transform_with_spark, run_id=scheduled__2024-06-27T00:03:30+00:00, execution_date=20240627T000330, start_date=20240628T013333, end_date=20240628T013409
[2024-06-27T21:34:14.428-0400] {standard_task_runner.py:110} ERROR - Failed to execute job 312 for task transform_with_spark ((sqlite3.OperationalError) database is locked
[SQL: SELECT task_instance.try_number AS task_instance_try_number, task_instance.task_display_name AS task_instance_task_display_name, task_instance.task_id AS task_instance_task_id, task_instance.dag_id AS task_instance_dag_id, task_instance.run_id AS task_instance_run_id, task_instance.map_index AS task_instance_map_index, task_instance.start_date AS task_instance_start_date, task_instance.end_date AS task_instance_end_date, task_instance.duration AS task_instance_duration, task_instance.state AS task_instance_state, task_instance.max_tries AS task_instance_max_tries, task_instance.hostname AS task_instance_hostname, task_instance.unixname AS task_instance_unixname, task_instance.job_id AS task_instance_job_id, task_instance.pool AS task_instance_pool, task_instance.pool_slots AS task_instance_pool_slots, task_instance.queue AS task_instance_queue, task_instance.priority_weight AS task_instance_priority_weight, task_instance.operator AS task_instance_operator, task_instance.custom_operator_name AS task_instance_custom_operator_name, task_instance.queued_dttm AS task_instance_queued_dttm, task_instance.queued_by_job_id AS task_instance_queued_by_job_id, task_instance.pid AS task_instance_pid, task_instance.executor_config AS task_instance_executor_config, task_instance.updated_at AS task_instance_updated_at, task_instance.rendered_map_index AS task_instance_rendered_map_index, task_instance.external_executor_id AS task_instance_external_executor_id, task_instance.trigger_id AS task_instance_trigger_id, task_instance.trigger_timeout AS task_instance_trigger_timeout, task_instance.next_method AS task_instance_next_method, task_instance.next_kwargs AS task_instance_next_kwargs, dag_run_1.state AS dag_run_1_state, dag_run_1.id AS dag_run_1_id, dag_run_1.dag_id AS dag_run_1_dag_id, dag_run_1.queued_at AS dag_run_1_queued_at, dag_run_1.execution_date AS dag_run_1_execution_date, dag_run_1.start_date AS dag_run_1_start_date, dag_run_1.end_date AS dag_run_1_end_date, dag_run_1.run_id AS dag_run_1_run_id, dag_run_1.creating_job_id AS dag_run_1_creating_job_id, dag_run_1.external_trigger AS dag_run_1_external_trigger, dag_run_1.run_type AS dag_run_1_run_type, dag_run_1.conf AS dag_run_1_conf, dag_run_1.data_interval_start AS dag_run_1_data_interval_start, dag_run_1.data_interval_end AS dag_run_1_data_interval_end, dag_run_1.last_scheduling_decision AS dag_run_1_last_scheduling_decision, dag_run_1.dag_hash AS dag_run_1_dag_hash, dag_run_1.log_template_id AS dag_run_1_log_template_id, dag_run_1.updated_at AS dag_run_1_updated_at, dag_run_1.clear_number AS dag_run_1_clear_number 
FROM task_instance JOIN dag_run AS dag_run_1 ON dag_run_1.dag_id = task_instance.dag_id AND dag_run_1.run_id = task_instance.run_id 
WHERE task_instance.dag_id = ? AND task_instance.task_id = ? AND task_instance.run_id = ? AND task_instance.map_index = ?]
[parameters: ('api_cuevana3_movie', 'transform_with_spark', 'scheduled__2024-06-27T00:03:30+00:00', -1)]
(Background on this error at: https://sqlalche.me/e/14/e3q8); 217354)
[2024-06-27T21:34:15.499-0400] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2024-06-27T21:34:15.522-0400] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-06-27T21:34:15.523-0400] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-06-28T11:06:26.311-0400] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-06-28T11:06:26.334-0400] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_cuevana3_movie.transform_with_spark scheduled__2024-06-27T00:03:30+00:00 [queued]>
[2024-06-28T11:06:26.340-0400] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_cuevana3_movie.transform_with_spark scheduled__2024-06-27T00:03:30+00:00 [queued]>
[2024-06-28T11:06:26.340-0400] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-06-28T11:06:26.372-0400] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): transform_with_spark> on 2024-06-27 00:03:30+00:00
[2024-06-28T11:06:26.382-0400] {standard_task_runner.py:63} INFO - Started process 238487 to run task
[2024-06-28T11:06:26.392-0400] {standard_task_runner.py:90} INFO - Running: ['airflow', 'tasks', 'run', 'api_cuevana3_movie', 'transform_with_spark', 'scheduled__2024-06-27T00:03:30+00:00', '--job-id', '484', '--raw', '--subdir', 'DAGS_FOLDER/movie_recommend.py', '--cfg-path', '/tmp/tmpp9asgb4d']
[2024-06-28T11:06:26.403-0400] {standard_task_runner.py:91} INFO - Job 484: Subtask transform_with_spark
[2024-06-28T11:06:26.500-0400] {task_command.py:426} INFO - Running <TaskInstance: api_cuevana3_movie.transform_with_spark scheduled__2024-06-27T00:03:30+00:00 [running]> on host walter-VirtualBox
[2024-06-28T11:06:26.705-0400] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='api_cuevana3_movie' AIRFLOW_CTX_TASK_ID='transform_with_spark' AIRFLOW_CTX_EXECUTION_DATE='2024-06-27T00:03:30+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-27T00:03:30+00:00'
[2024-06-28T11:06:26.706-0400] {taskinstance.py:430} INFO - ::endgroup::
[2024-06-28T11:06:43.815-0400] {python.py:237} INFO - Done. Returned value was: {'actors': ['Amy Poehler,', 'Maya Hawke,', 'Kensington Tallman,', 'Liza Lapira,', 'Phyllis Smith,', 'Lewis Black,', 'Tony Hale,', 'Ayo Edebiri,', 'Adèle Exarchopoulos,', 'Lilimar,', 'Grace Lu,', 'Sumayyah Nuriddin-Green,', 'Diane Lane,', 'Kyle MacLachlan,', 'Paul Walter Hauser,', 'Yvette Nicole Brown,', 'Ron Funches,', 'James Austin Johnson,', 'Yong Yea,', 'Steve Purcell,', 'Dave Goelz,'], 'country': 'United States', 'description': 'Vuelve a la mente de Riley, quien acaba de convertirse en adolescente, en el momento en que la Central se enfrenta a una reforma para hacer sitio a algo completamente inesperado: ¡nuevas Emociones! Alegría, Tristeza, Ira, Miedo y Asco, que llevan muchos años al mando de una operación exitosa, no saben muy bien qué sentir cuando aparece Ansiedad, que además no ha llegado sola. Se ha traído a Vergüenza, Envidia y Ennui.', 'director': 'Kelsey Mann', 'duration': 97, 'genre': ['Animación', 'Familia', 'Aventura', 'Comedia'], 'image_url': 'https://i0.wp.com/www.themoviedb.org/t/p/w185/2PuAY3xSvbchQWqpSiXw08Yt0NP.jpg', 'quality': 'HD', 'rating': 7.7, 'title': 'Del revés 2 (Inside Out 2)', 'views': 979, 'year': '2024'}
[2024-06-28T11:06:43.816-0400] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-06-28T11:06:43.840-0400] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=api_cuevana3_movie, task_id=transform_with_spark, run_id=scheduled__2024-06-27T00:03:30+00:00, execution_date=20240627T000330, start_date=20240628T150626, end_date=20240628T150643
[2024-06-28T11:06:43.943-0400] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-06-28T11:06:43.983-0400] {taskinstance.py:3503} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-06-28T11:06:44.034-0400] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-06-28T11:22:29.045-0400] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-06-28T11:22:29.077-0400] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_cuevana3_movie.transform_with_spark scheduled__2024-06-27T00:03:30+00:00 [queued]>
[2024-06-28T11:22:29.090-0400] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_cuevana3_movie.transform_with_spark scheduled__2024-06-27T00:03:30+00:00 [queued]>
[2024-06-28T11:22:29.091-0400] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-06-28T11:22:29.123-0400] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): transform_with_spark> on 2024-06-27 00:03:30+00:00
[2024-06-28T11:22:29.141-0400] {standard_task_runner.py:63} INFO - Started process 242282 to run task
[2024-06-28T11:22:29.146-0400] {standard_task_runner.py:90} INFO - Running: ['airflow', 'tasks', 'run', 'api_cuevana3_movie', 'transform_with_spark', 'scheduled__2024-06-27T00:03:30+00:00', '--job-id', '535', '--raw', '--subdir', 'DAGS_FOLDER/movie_recommend.py', '--cfg-path', '/tmp/tmpucwjw1gk']
[2024-06-28T11:22:29.148-0400] {standard_task_runner.py:91} INFO - Job 535: Subtask transform_with_spark
[2024-06-28T11:22:29.252-0400] {task_command.py:426} INFO - Running <TaskInstance: api_cuevana3_movie.transform_with_spark scheduled__2024-06-27T00:03:30+00:00 [running]> on host walter-VirtualBox
[2024-06-28T11:22:29.416-0400] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='api_cuevana3_movie' AIRFLOW_CTX_TASK_ID='transform_with_spark' AIRFLOW_CTX_EXECUTION_DATE='2024-06-27T00:03:30+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-27T00:03:30+00:00'
[2024-06-28T11:22:29.418-0400] {taskinstance.py:430} INFO - ::endgroup::
[2024-06-28T11:22:53.179-0400] {python.py:237} INFO - Done. Returned value was: {'actors': ['Amy Poehler,', 'Maya Hawke,', 'Kensington Tallman,', 'Liza Lapira,', 'Phyllis Smith,', 'Lewis Black,', 'Tony Hale,', 'Ayo Edebiri,', 'Adèle Exarchopoulos,', 'Lilimar,', 'Grace Lu,', 'Sumayyah Nuriddin-Green,', 'Diane Lane,', 'Kyle MacLachlan,', 'Paul Walter Hauser,', 'Yvette Nicole Brown,', 'Ron Funches,', 'James Austin Johnson,', 'Yong Yea,', 'Steve Purcell,', 'Dave Goelz,'], 'country': 'United States', 'description': 'Vuelve a la mente de Riley, quien acaba de convertirse en adolescente, en el momento en que la Central se enfrenta a una reforma para hacer sitio a algo completamente inesperado: ¡nuevas Emociones! Alegría, Tristeza, Ira, Miedo y Asco, que llevan muchos años al mando de una operación exitosa, no saben muy bien qué sentir cuando aparece Ansiedad, que además no ha llegado sola. Se ha traído a Vergüenza, Envidia y Ennui.', 'director': 'Kelsey Mann', 'duration': 97, 'genre': ['Animación', 'Familia', 'Aventura', 'Comedia'], 'image_url': 'https://i0.wp.com/www.themoviedb.org/t/p/w185/2PuAY3xSvbchQWqpSiXw08Yt0NP.jpg', 'quality': 'HD', 'rating': 7.7, 'title': 'Del revés 2 (Inside Out 2)', 'views': 979, 'year': '2024'}
[2024-06-28T11:22:53.180-0400] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-06-28T11:22:53.204-0400] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=api_cuevana3_movie, task_id=transform_with_spark, run_id=scheduled__2024-06-27T00:03:30+00:00, execution_date=20240627T000330, start_date=20240628T152229, end_date=20240628T152253
[2024-06-28T11:22:53.281-0400] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-06-28T11:22:53.340-0400] {taskinstance.py:3503} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-06-28T11:22:53.368-0400] {local_task_job_runner.py:222} INFO - ::endgroup::
