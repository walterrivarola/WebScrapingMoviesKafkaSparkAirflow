[2024-06-28 23:00:01,263] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2024-06-28 23:00:01,264] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2024-06-28 23:00:01,269] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap(airflow-kafka-spark-1 -> List(1, 2), movie-recommendation-1 -> List(1, 3)) (kafka.controller.KafkaController)
[2024-06-28 23:00:01,269] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 0.09090909090909091 (kafka.controller.KafkaController)
[2024-06-28 23:00:01,270] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2024-06-28 23:00:01,270] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2024-06-28 23:00:01,270] DEBUG [Controller id=2] Topics not in preferred replica for broker 3 HashMap(movie-recommendation-0 -> List(3, 2)) (kafka.controller.KafkaController)
[2024-06-28 23:00:01,270] TRACE [Controller id=2] Leader imbalance ratio for broker 3 is 0.05 (kafka.controller.KafkaController)
[2024-06-28 23:03:41,154] INFO [Controller id=2] New topics: [HashSet(movie-urls)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(movie-urls,Some(e_M0FelPS4m4B4IVtaOg2g),Map(movie-urls-0 -> ReplicaAssignment(replicas=3, addingReplicas=, removingReplicas=), movie-urls-1 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), movie-urls-2 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2024-06-28 23:03:41,163] INFO [Controller id=2] New partition creation callback for movie-urls-0,movie-urls-1,movie-urls-2 (kafka.controller.KafkaController)
[2024-06-28 23:03:41,447] INFO [RequestSendThread controllerId=2] Controller 2 connected to walter-VirtualBox:9093 (id: 3 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2024-06-28 23:03:41,447] INFO [RequestSendThread controllerId=2] Controller 2 connected to walter-VirtualBox:9092 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2024-06-28 23:03:41,448] INFO [RequestSendThread controllerId=2] Controller 2 connected to walter-VirtualBox:9091 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2024-06-28 23:04:16,080] INFO [Controller id=2] New topics: [HashSet(movie-details)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(movie-details,Some(cqG8pNEBRYqZhGcd9fo9Qg),Map(movie-details-0 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), movie-details-1 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), movie-details-2 -> ReplicaAssignment(replicas=3, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2024-06-28 23:04:16,081] INFO [Controller id=2] New partition creation callback for movie-details-0,movie-details-1,movie-details-2 (kafka.controller.KafkaController)
[2024-06-28 23:05:01,271] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2024-06-28 23:05:01,271] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2024-06-28 23:05:01,277] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap(airflow-kafka-spark-1 -> List(1, 2), movie-recommendation-1 -> List(1, 3)) (kafka.controller.KafkaController)
[2024-06-28 23:05:01,278] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 0.08333333333333333 (kafka.controller.KafkaController)
[2024-06-28 23:05:01,278] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2024-06-28 23:05:01,278] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2024-06-28 23:05:01,279] DEBUG [Controller id=2] Topics not in preferred replica for broker 3 HashMap(movie-recommendation-0 -> List(3, 2)) (kafka.controller.KafkaController)
[2024-06-28 23:05:01,279] TRACE [Controller id=2] Leader imbalance ratio for broker 3 is 0.045454545454545456 (kafka.controller.KafkaController)
[2024-06-28 23:10:01,280] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2024-06-28 23:10:01,281] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2024-06-28 23:10:01,284] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap(airflow-kafka-spark-1 -> List(1, 2), movie-recommendation-1 -> List(1, 3)) (kafka.controller.KafkaController)
[2024-06-28 23:10:01,284] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 0.08333333333333333 (kafka.controller.KafkaController)
[2024-06-28 23:10:01,284] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2024-06-28 23:10:01,284] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2024-06-28 23:10:01,284] DEBUG [Controller id=2] Topics not in preferred replica for broker 3 HashMap(movie-recommendation-0 -> List(3, 2)) (kafka.controller.KafkaController)
[2024-06-28 23:10:01,284] TRACE [Controller id=2] Leader imbalance ratio for broker 3 is 0.045454545454545456 (kafka.controller.KafkaController)
[2024-06-28 23:13:09,789] DEBUG [Controller id=2] Read current producerId block ProducerIdsBlock(assignedBrokerId=2, firstProducerId=2000, size=1000), Zk path version 3 (kafka.controller.KafkaController)
[2024-06-28 23:13:09,819] INFO [Controller id=2] Acquired new producerId block ProducerIdsBlock(assignedBrokerId=3, firstProducerId=3000, size=1000) by writing to Zk with path version 4 (kafka.controller.KafkaController)
[2024-06-28 23:13:09,970] DEBUG [Controller id=2] Read current producerId block ProducerIdsBlock(assignedBrokerId=3, firstProducerId=3000, size=1000), Zk path version 4 (kafka.controller.KafkaController)
[2024-06-28 23:13:09,975] INFO [Controller id=2] Acquired new producerId block ProducerIdsBlock(assignedBrokerId=1, firstProducerId=4000, size=1000) by writing to Zk with path version 5 (kafka.controller.KafkaController)
[2024-06-28 23:15:01,287] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2024-06-28 23:15:01,288] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2024-06-28 23:15:01,300] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap(airflow-kafka-spark-1 -> List(1, 2), movie-recommendation-1 -> List(1, 3)) (kafka.controller.KafkaController)
[2024-06-28 23:15:01,300] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 0.08333333333333333 (kafka.controller.KafkaController)
[2024-06-28 23:15:01,301] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2024-06-28 23:15:01,301] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2024-06-28 23:15:01,301] DEBUG [Controller id=2] Topics not in preferred replica for broker 3 HashMap(movie-recommendation-0 -> List(3, 2)) (kafka.controller.KafkaController)
[2024-06-28 23:15:01,301] TRACE [Controller id=2] Leader imbalance ratio for broker 3 is 0.045454545454545456 (kafka.controller.KafkaController)
