[2024-05-30 11:01:27,294] ERROR [Controller id=2] Error while electing or becoming controller on broker 2. Trigger controller movement immediately (kafka.controller.KafkaController)
org.apache.zookeeper.KeeperException$SessionExpiredException: KeeperErrorCode = Session expired
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:134)
	at kafka.zk.KafkaZkClient.tryCreateControllerZNodeAndIncrementEpoch$1(KafkaZkClient.scala:162)
	at kafka.zk.KafkaZkClient.registerControllerAndIncrementControllerEpoch(KafkaZkClient.scala:166)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1560)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2581)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2586)
	at kafka.controller.KafkaController.process(KafkaController.scala:2628)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:130)
[2024-05-30 11:01:58,844] ERROR [Controller id=2] Error processing event RegisterBrokerAndReelect (kafka.controller.KafkaController)
org.apache.zookeeper.KeeperException$SessionExpiredException: KeeperErrorCode = Session expired for /controller
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:134)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at kafka.zookeeper.AsyncResponse.resultException(ZooKeeperClient.scala:563)
	at kafka.zk.KafkaZkClient.getControllerId(KafkaZkClient.scala:1226)
	at kafka.controller.KafkaController.triggerControllerMove(KafkaController.scala:1522)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1580)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2581)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2586)
	at kafka.controller.KafkaController.process(KafkaController.scala:2628)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:130)
[2024-05-30 11:02:00,802] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2024-05-30 11:02:00,854] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2024-05-30 11:02:00,854] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2024-05-30 11:02:00,854] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2024-05-30 11:02:00,900] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2024-05-30 11:02:03,654] DEBUG [Controller id=2] Broker 1 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2024-05-30 11:06:05,183] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2024-05-30 11:06:13,589] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2024-05-30 11:06:13,590] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2024-05-30 11:06:13,590] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2024-05-30 11:06:13,590] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
